(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-549e183c"],{"02e4":function(e,t,r){"use strict";var s=r("9a76"),i=r.n(s);i.a},8473:function(e,t,r){"use strict";var s=r("d0b1"),i=r.n(s);i.a},9406:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"dashboard-container"},[r("div",{staticClass:"dashboard-text"},[e._v("name(用户权限等级):"+e._s(e.name))]),e._v(" "),r("div",{staticClass:"dashboard-text"},[e._v("roles(按钮级别权限):"+e._s(e.roles))]),e._v(" "),r("h2",[e._v("关于路由")]),e._v(" "),r("div",{staticClass:"dashboard-text"},[e._v("\n    权限标签"+e._s(e.name)+" 的路由为 "+e._s(e.showRouter)+"\n  ")]),e._v(" "),r("div",[e._v("未解析路由信息请看NetWork的,解析完成的路由信息请看控制台")]),e._v(" "),r("h2",[e._v("关于权限")]),e._v(" "),r("p",[e._v("这里做了简单的权限区分,")]),e._v(" "),r("p",[e._v('\n    admin 用户存在 "add", "delete", "edit", "view"\n    ,所以根据自定义指令管理员可以操作的按钮都会被渲染出来\n  ')]),e._v(" "),r("p",[e._v('\n    editor 用户只存在 "edit", "view" ,所以自定义指令/v-if不会渲染 增加 与 删除\n  ')]),e._v(" "),r("h3",[e._v("自定义指令的实现")]),e._v(" "),r("el-button",{directives:[{name:"permit",rawName:"v-permit",value:"add",expression:"'add'"}],attrs:{type:"primary"}},[e._v("增加")]),e._v(" "),r("el-button",{directives:[{name:"permit",rawName:"v-permit",value:"delete",expression:"'delete'"}],attrs:{type:"danger"}},[e._v("删除")]),e._v(" "),r("el-button",{directives:[{name:"permit",rawName:"v-permit",value:"edit",expression:"'edit'"}],attrs:{type:"warning"}},[e._v("修改")]),e._v(" "),r("el-button",{directives:[{name:"permit",rawName:"v-permit",value:"view",expression:"'view'"}],attrs:{type:"success"}},[e._v("查看")]),e._v(" "),r("h3",[e._v("v-if的实现")]),e._v(" "),e.basePermit("add")?r("el-button",{attrs:{type:"primary"}},[e._v("增加")]):e._e(),e._v(" "),e.basePermit("delete")?r("el-button",{attrs:{type:"danger"}},[e._v("删除")]):e._e(),e._v(" "),e.basePermit("edit")?r("el-button",{attrs:{type:"warning"}},[e._v("修改")]):e._e(),e._v(" "),e.basePermit("view")?r("el-button",{attrs:{type:"success"}},[e._v("查看")]):e._e(),e._v(" "),r("div",{staticClass:"toggle"},[r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.toggleShow}},[e._v("\n      代码思路\n    ")]),e._v(" "),r("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.toggleUser}},[e._v("\n      切换用户\n    ")])],1),e._v(" "),r("user-show",{attrs:{show:e.show},on:{closeDialog:e.toggleShow}})],1)},i=[],n=(r("5ab2"),r("6d57"),r("e10e"),r("ed63"),r("8cf2"),r("cc57"),r("88d6")),o=r("52c1"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"思路",visible:e.show,width:"800px","before-close":e.closeDialog},on:{"update:visible":function(t){e.show=t}}},[r("div",[r("h2",[e._v("\n      代码运行思路(已经登录,刷新页面的情况下)\n    ")]),e._v(" "),r("div",{staticClass:"item"},[r("div",[e._v("1. 在路由钩子里面判断是否首次进入系统(permission.js)")]),e._v(" "),r("div",[e._v("\n        2.\n        init为true说明已经获取过路由,就直接放行,init为false则向后台请求用户路由\n      ")]),e._v(" "),r("div",[e._v("3. 获取路由")]),e._v(" "),r("div",[e._v("4. 解析路由,存储权限")]),e._v(" "),r("div",[e._v("5. 使用router的api,addRouter拼接路由")]),e._v(" "),r("div",[e._v("6. 存储路由")]),e._v(" "),r("div",[e._v("7. init改为true,路由初始化完成")]),e._v(" "),r("div",[e._v("8. 放行路由")])])])])},v=[],c={props:{show:{type:Boolean,default:!1}},methods:{closeDialog:function(){this.$emit("closeDialog")}}},l=c,d=(r("8473"),r("4023")),u=Object(d["a"])(l,a,v,!1,null,"5ecfae9a",null),_=u.exports;function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,s)}return r}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){Object(n["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var m={name:"Dashboard",components:{userShow:_},data:function(){return{show:!1}},computed:h(h({},Object(o["b"])(["name","roles"])),{},{showRouter:function(){return console.log("全部路由信息",this.$store.getters.routerList),this.$store.getters.routerList.length>0?this.$store.getters.routerList.reduce((function(e,t){return e.concat(t.path)}),[]):""}}),methods:{toggleUser:function(){var e=this;"Normal Editor"===this.name?this.$store.dispatch("user/login",{username:"admin",password:""}).then((function(){location.reload()})).catch((function(){e.$message("接口出现了一些问题....")})):"Super Admin"===this.name&&this.$store.dispatch("user/login",{username:"editor",password:""}).then((function(){location.reload()})).catch((function(){e.$message("接口出现了一些问题....")}))},basePermit:function(e){return this.$store.getters.roles.includes(e)},toggleShow:function(){this.show=!this.show}}},b=m,f=(r("02e4"),Object(d["a"])(b,s,i,!1,null,"080dda48",null));t["default"]=f.exports},"9a76":function(e,t,r){},d0b1:function(e,t,r){}}]);